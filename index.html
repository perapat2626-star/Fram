<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farm Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; text-align: center; padding: 20px; }
        .card { background: #1e293b; padding: 20px; border-radius: 15px; margin: 10px auto; max-width: 380px; border: 1px solid #334155; }
        .percent { font-size: 60px; color: #22c55e; font-weight: bold; }
        .btn { width: 45%; padding: 12px; margin: 5px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; color: white; }
        .on { background: #10b981; } .off { background: #ef4444; }
        .status { display: inline-block; padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-bottom: 10px; border: 1px solid; }
        .s-on { color: #34d399; border-color: #34d399; } .s-off { color: #f87171; border-color: #f87171; }
        input[type='time'] { width: 80%; padding: 10px; margin: 5px; border-radius: 8px; font-size: 18px; }
    </style>
</head>
<body>
    <h2>üå± Smart Farm Remote</h2>
    <div class="card">
        <p>üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÉ‡∏ô‡∏î‡∏¥‡∏ô</p>
        <div id="moist-pct" class="percent">0</div> %
    </div>

    <div class="card">
        <h3>üí° ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏™‡πà‡∏≠‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á</h3>
        <div id="l-stat" class="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div><br>
        <button onclick="set('light','ON')" class="btn on">‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü</button>
        <button onclick="set('light','OFF')" class="btn off">‡∏õ‡∏¥‡∏î‡πÑ‡∏ü</button>
        <hr style="border:0.1px solid #334155; margin:15px;">
        ‡πÄ‡∏õ‡∏¥‡∏î: <input type="time" id="onT"> ‡∏õ‡∏¥‡∏î: <input type="time" id="offT">
        <button onclick="saveT()" class="btn" style="background:#3b82f6; width:90%">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</button>
    </div>

    <div class="card">
        <h3>üíß ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥</h3>
        <div id="p-stat" class="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div><br>
        <button onclick="set('pump','ON')" class="btn on">‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°</button>
        <button onclick="set('pump','OFF')" class="btn off">‡∏õ‡∏¥‡∏î‡∏õ‡∏±‡πä‡∏°</button>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://fram-1fd7e-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ‡∏î‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ö‡∏°‡∏≤‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô % (0-1023 -> 100-0%)
        db.ref("status/moisture").on("value", s => {
            let pct = Math.round(((1023 - s.val()) / 1023) * 100);
            document.getElementById("moist-pct").innerText = pct;
        });

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
        db.ref("control/light").on("value", s => {
            document.getElementById("l-stat").innerText = s.val() == "ON" ? "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏õ‡∏¥‡∏î" : "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏õ‡∏¥‡∏î";
            document.getElementById("l-stat").className = "status " + (s.val() == "ON" ? "s-on" : "s-off");
        });
        db.ref("control/pump").on("value", s => {
            document.getElementById("p-stat").innerText = s.val() == "ON" ? "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏õ‡∏¥‡∏î" : "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏õ‡∏¥‡∏î";
            document.getElementById("p-stat").className = "status " + (s.val() == "ON" ? "s-on" : "s-off");
        });

        function set(t, a) { db.ref("control/" + t).set(a); }
        function saveT() {
            const on = document.getElementById("onT").value;
            const off = document.getElementById("offT").value;
            db.ref("timer").set({on, off}); alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß");
        }
    </script>
</body>
</html>
