<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farm Control</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; background: #0f172a; color: white; text-align: center; padding: 20px; }
        .card { background: #1e293b; padding: 20px; border-radius: 15px; margin: 10px auto; max-width: 350px; border: 1px solid #334155; }
        .btn { width: 45%; padding: 15px; margin: 5px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; color: white; }
        .on { background: #22c55e; } .off { background: #ef4444; }
        .save { background: #3b82f6; width: 90%; margin-top: 10px; }
        input[type='time'] { width: 80%; padding: 10px; margin: 5px; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; font-size: 18px; }
        #moist { font-size: 40px; color: #22c55e; font-weight: bold; }
    </style>
</head>
<body>
    <h2>üöÄ Smart Farm Real-time</h2>
    <div class="card">
        üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô: <span id="moist">--</span> %
    </div>

    <div class="card">
        <h3>‚è∞ ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏ü‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</h3>
        ‡πÄ‡∏õ‡∏¥‡∏î: <input type="time" id="onTime"><br>
        ‡∏õ‡∏¥‡∏î: <input type="time" id="offTime"><br>
        <button onclick="saveTimer()" class="btn save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</button>
    </div>

    <div class="card">
        <h3>üéÆ ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</h3>
        <p>‡πÑ‡∏ü: <button onclick="set('light','ON')" class="btn on">‡πÄ‡∏õ‡∏¥‡∏î</button><button onclick="set('light','OFF')" class="btn off">‡∏õ‡∏¥‡∏î</button></p>
        <p>‡∏õ‡∏±‡πä‡∏°: <button onclick="set('pump','ON')" class="btn on">‡πÄ‡∏õ‡∏¥‡∏î</button><button onclick="set('pump','OFF')" class="btn off">‡∏õ‡∏¥‡∏î</button></p>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://fram-1fd7e-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡∏°‡∏≤‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input
        db.ref("timer").on("value", (snapshot) => {
            const data = snapshot.val();
            if(data) {
                document.getElementById("onTime").value = data.on;
                document.getElementById("offTime").value = data.off;
            }
        });

        db.ref("status/moisture").on("value", (snapshot) => {
            document.getElementById("moist").innerText = snapshot.val();
        });

        function set(target, action) { db.ref("control/" + target).set(action); }

        function saveTimer() {
            const on = document.getElementById("onTime").value;
            const off = document.getElementById("offTime").value;
            if(on && off) {
                db.ref("timer").set({ on: on, off: off });
                alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß");
            }
        }
    </script>
</body>
</html>
